{"ast":null,"code":"import _defineProperty from\"/home/rahul/Desktop/projects/crwn-clothing/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/rahul/Desktop/projects/crwn-clothing/client/node_modules/@babel/runtime/regenerator\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}var _marked=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(getSnapshotFromUserAuth),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onUserSignOutStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onUserSignUpStart),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(signInAfterSignUp),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpSuccess),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,all,call}from\"redux-saga/effects\";import{UserActionTypes}from\"./user.types\";import{auth,googleprovider,getCurrentUser,createUserProfileDocument}from\"../../firebase/firebase.utils\";import{signInSuccess,signInFailure,signOutSuccess,signOutFailure,signUpSuccess,signUpFailure}from\"../user/user.actions\";export function signInWithGoogle(){var _ref,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return auth.signInWithPopup(googleprovider);case 3:_ref=_context.sent;user=_ref.user;_context.next=7;return getSnapshotFromUserAuth(user);case 7:_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);_context.next=13;return put(signInFailure(_context.t0));case 13:case\"end\":return _context.stop();}}},_marked,null,[[0,9]]);}export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context2.stop();}}},_marked2);}export function signInWithEmail(_ref2){var _ref2$payload,email,password,_ref3,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref2$payload=_ref2.payload,email=_ref2$payload.email,password=_ref2$payload.password;_context3.prev=1;_context3.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_ref3=_context3.sent;user=_ref3.user;_context3.next=8;return getSnapshotFromUserAuth(user);case 8:_context3.next=14;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](1);_context3.next=14;return put(signInFailure(_context3.t0));case 14:case\"end\":return _context3.stop();}}},_marked3,null,[[1,10]]);}export function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context4.stop();}}},_marked4);}export function getSnapshotFromUserAuth(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapshotFromUserAuth$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context5.sent;_context5.next=6;return userRef.get();case 6:userSnapshot=_context5.sent;_context5.next=9;return put(signInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context5.next=15;break;case 11:_context5.prev=11;_context5.t0=_context5[\"catch\"](0);_context5.next=15;return put(signInFailure(_context5.t0));case 15:case\"end\":return _context5.stop();}}},_marked5,null,[[0,11]]);}export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return getCurrentUser();case 3:userAuth=_context6.sent;if(userAuth){_context6.next=6;break;}return _context6.abrupt(\"return\");case 6:_context6.next=8;return getSnapshotFromUserAuth(userAuth);case 8:_context6.next=14;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);_context6.next=14;return put(signInFailure(_context6.t0));case 14:case\"end\":return _context6.stop();}}},_marked6,null,[[0,10]]);}export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context7.stop();}}},_marked7);}export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return auth.signOut();case 3:_context8.next=5;return put(signOutSuccess());case 5:_context8.next=11;break;case 7:_context8.prev=7;_context8.t0=_context8[\"catch\"](0);_context8.next=11;return put(signOutFailure(_context8.t0));case 11:case\"end\":return _context8.stop();}}},_marked8,null,[[0,7]]);}export function onUserSignOutStart(){return _regeneratorRuntime.wrap(function onUserSignOutStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(UserActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context9.stop();}}},_marked9);}export function signUp(_ref4){var _ref4$payload,email,password,displayName,_ref5,user;return _regeneratorRuntime.wrap(function signUp$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_ref4$payload=_ref4.payload,email=_ref4$payload.email,password=_ref4$payload.password,displayName=_ref4$payload.displayName;_context10.prev=1;_context10.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_ref5=_context10.sent;user=_ref5.user;_context10.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context10.next=14;break;case 10:_context10.prev=10;_context10.t0=_context10[\"catch\"](1);_context10.next=14;return put(signUpFailure(_context10.t0));case 14:case\"end\":return _context10.stop();}}},_marked10,null,[[1,10]]);}export function onUserSignUpStart(){return _regeneratorRuntime.wrap(function onUserSignUpStart$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context11.stop();}}},_marked11);}export function signInAfterSignUp(_ref6){var _ref6$payload,user,additionalData;return _regeneratorRuntime.wrap(function signInAfterSignUp$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_ref6$payload=_ref6.payload,user=_ref6$payload.user,additionalData=_ref6$payload.additionalData;_context12.next=3;return getSnapshotFromUserAuth(user,additionalData);case 3:case\"end\":return _context12.stop();}}},_marked12);}export function onSignUpSuccess(){return _regeneratorRuntime.wrap(function onSignUpSuccess$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signInAfterSignUp);case 2:case\"end\":return _context13.stop();}}},_marked13);}export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(onCheckUserSession),call(onUserSignOutStart),call(onUserSignUpStart),call(onSignUpSuccess)]);case 2:case\"end\":return _context14.stop();}}},_marked14);}","map":{"version":3,"sources":["/home/rahul/Desktop/projects/crwn-clothing/client/src/redux/user/user.sagas.js"],"names":["signInWithGoogle","onGoogleSignInStart","signInWithEmail","onEmailSignInStart","getSnapshotFromUserAuth","isUserAuthenticated","onCheckUserSession","signOut","onUserSignOutStart","signUp","onUserSignUpStart","signInAfterSignUp","onSignUpSuccess","userSagas","takeLatest","put","all","call","UserActionTypes","auth","googleprovider","getCurrentUser","createUserProfileDocument","signInSuccess","signInFailure","signOutSuccess","signOutFailure","signUpSuccess","signUpFailure","signInWithPopup","user","GOOGLE_SIGN_IN_START","payload","email","password","signInWithEmailAndPassword","EMAIL_SIGN_IN_START","userAuth","additionalData","userRef","get","userSnapshot","id","data","CHECK_USER_SESSION","SIGN_OUT_START","displayName","createUserWithEmailAndPassword","SIGN_UP_START","SIGN_UP_SUCCESS"],"mappings":"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","sourcesContent":["import { takeLatest, put, all, call } from \"redux-saga/effects\";\nimport { UserActionTypes } from \"./user.types\";\nimport { auth, googleprovider, getCurrentUser, createUserProfileDocument } from \"../../firebase/firebase.utils\";\nimport { signInSuccess, signInFailure, signOutSuccess, signOutFailure, signUpSuccess, signUpFailure } from \"../user/user.actions\";\n\nexport function* signInWithGoogle() {\n    try {\n        const { user } = yield auth.signInWithPopup(googleprovider);\n        yield getSnapshotFromUserAuth(user);\n    } catch (error) {\n        yield put(signInFailure(error))\n    }\n}\n\nexport function* onGoogleSignInStart() {\n    yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START, signInWithGoogle)\n}\n\nexport function* signInWithEmail({ payload: { email, password } }) {\n    try {\n        const { user } = yield auth.signInWithEmailAndPassword(email, password);\n        yield getSnapshotFromUserAuth(user);\n    }\n    catch (error) {\n        yield put(signInFailure(error))\n    }\n}\n\nexport function* onEmailSignInStart() {\n    yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START, signInWithEmail)\n}\n\n\nexport function* getSnapshotFromUserAuth(userAuth, additionalData) {\n    try {\n        const userRef = yield call(createUserProfileDocument, userAuth, additionalData);\n        const userSnapshot = yield userRef.get();\n        yield put(\n            signInSuccess({ id: userSnapshot.id, ...userSnapshot.data() })\n        );\n    }\n    catch (error) {\n        yield put(signInFailure(error))\n    }\n}\n\nexport function* isUserAuthenticated() {\n    try {\n        const userAuth = yield getCurrentUser();\n        if (!userAuth) return;\n        yield getSnapshotFromUserAuth(userAuth)\n    } catch (error) {\n        yield put(signInFailure(error))\n    }\n}\n\nexport function* onCheckUserSession() {\n    yield takeLatest(UserActionTypes.CHECK_USER_SESSION, isUserAuthenticated)\n}\n\nexport function* signOut() {\n    try {\n        yield auth.signOut();\n        yield put(signOutSuccess());\n    } catch (error) {\n        yield put(signOutFailure(error));\n    }\n}\n\nexport function* onUserSignOutStart() {\n    yield takeLatest(UserActionTypes.SIGN_OUT_START, signOut)\n}\n\nexport function* signUp({ payload: { email, password, displayName } }) {\n    try {\n        const { user } = yield auth.createUserWithEmailAndPassword(email, password)\n        yield put(signUpSuccess({ user, additionalData: { displayName } }))\n    } catch (error) {\n        yield put(signUpFailure(error))\n    }\n}\n\nexport function* onUserSignUpStart() {\n    yield takeLatest(UserActionTypes.SIGN_UP_START, signUp)\n}\n\nexport function* signInAfterSignUp({ payload: { user, additionalData } }) {\n    yield getSnapshotFromUserAuth(user, additionalData)\n}\n\nexport function* onSignUpSuccess() {\n    yield takeLatest(UserActionTypes.SIGN_UP_SUCCESS, signInAfterSignUp)\n}\n\nexport function* userSagas() {\n    yield all([\n        call(onGoogleSignInStart),\n        call(onEmailSignInStart),\n        call(onCheckUserSession),\n        call(onUserSignOutStart),\n        call(onUserSignUpStart),\n        call(onSignUpSuccess)\n    ])\n}"]},"metadata":{},"sourceType":"module"}